@model IOCL_Training_Module.Models.SubordinateTrainingViewModel

@{
    ViewData["Title"] = "Subordinate Completed Trainings";
}

<div class="container mt-4">
    <h2>Completed Trainings of Subordinates</h2>

    <!-- 🔹 Filter Form -->
    <form method="get">
        <div class="row">
            <!-- 🔹 Subordinate Selection Dropdown -->
            <div class="col-md-3">
                <label for="selectedEmpNo">Select Employee:</label>
                <select name="selectedEmpNo" id="selectedEmpNo" class="form-control">
                    <option value="">-- Select Employee --</option>
                    @foreach (var emp in Model.Subordinates)
                    {
                        <option value="@emp.EmpNo" selected="@(emp.EmpNo == Model.SelectedEmpNo)">
                            @emp.EmpNo - @emp.Name
                        </option>
                    }
                </select>
            </div>

            <!-- 🔹 Training Name -->
            <div class="col-md-3">
                <label for="trainingName">Training Name:</label>
                <input type="text" name="trainingName" id="trainingName" class="form-control" value="@Context.Request.Query["trainingName"]" />
            </div>

            <!-- 🔹 Training Type Dropdown -->
            <div class="col-md-3">
                <label for="type">Type:</label>
                <select name="type" id="type" class="form-control">
                    <option value="">-- Select Type --</option>
                    @foreach (var type in ViewBag.TrainingTypes)
                    {
                        <option value="@type.Value" selected="@(type.Value == Context.Request.Query["type"])">@type.Text</option>
                    }
                </select>
            </div>

            <!-- 🔹 Department Dropdown -->
            <div class="col-md-3">
                <label for="department">Department:</label>
                <select name="department" id="department" class="form-control">
                    <option value="">-- Select Department --</option>
                    @foreach (var dept in ViewBag.Departments)
                    {
                        <option value="@dept.Value" selected="@(dept.Value == Context.Request.Query["department"])">@dept.Text</option>
                    }
                </select>
            </div>

            <!-- 🔹 Date Filters -->
            <div class="col-md-3 mt-2">
                <label for="fromDate">From Date:</label>
                <input type="date" name="fromDate" id="fromDate" class="form-control" value="@Context.Request.Query["fromDate"]" />
            </div>
            <div class="col-md-3 mt-2">
                <label for="toDate">To Date:</label>
                <input type="date" name="toDate" id="toDate" class="form-control" value="@Context.Request.Query["toDate"]" />
            </div>

            <!-- 🔹 Submit Button -->
            <div class="col-md-3 mt-4">
                <button type="submit" class="btn btn-primary">Apply Filters</button>
            </div>
        </div>
    </form>

    <!-- 🔹 Completed Trainings Table -->
    @if (Model.CompletedTrainings.Any())
    {
        <table class="table table-bordered table-hover mt-4">
            <thead class="thead-dark">
                <tr>
                    <th>Training Code</th>
                    <th>Training Name</th>
                    <th>Employee No</th>
                    <th>From Date</th>
                    <th>To Date</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var training in Model.CompletedTrainings)
                {
                    <tr>
                        <td>@training.Training?.TrainingID</td>
                        <td>@training.Training?.TrainingName</td>
                        <td>@training.EmpNo</td>
                        <td>@training.FromDate.ToShortDateString()</td>
                        <td>@training.ToDate.ToShortDateString()</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p>No completed trainings found.</p>
    }
</div>
